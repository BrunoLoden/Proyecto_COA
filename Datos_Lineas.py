# -*- coding: utf-8 -*-
"""
Created on Wed Dec  7 09:59:41 2022

@author: Bruno
"""
from Datos_DemandaCOES     import Dem




#print("Demanda (t)")    
#print(Dem)


#=============================================================================
#==============================LINEAS=========================================
#=============================================================================
#nodos 
N = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
     14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]

T =   [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 
     14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]

Sb = 100
slack = 13
VOLL = 800


#datos de generación térmica
BusE =   {"E1":18,   "E2":21, "E3":1}
BusG =   {"G1":23,   "G2":7,  "G3":13, "G4":15, "G5":22}
BusH =   {"H1":2,    "H2":15, "H3":16, "H4":23}

#=============================================================================
#=============================================================================
#=============================================================================

#datos de las lineas

L = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
     21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34]

BusL = { 1:( 1,  2),  2:( 1,  3),  3:( 1,  5),  4:( 2,  4),  5:( 2,  6),
         6:( 3,  9),  7:( 3, 24),  8:( 4,  9),  9:( 5, 10), 10:( 6, 10),
        11:( 7,  8), 12:( 8,  9), 13:( 8, 10), 14:( 9, 11), 15:( 9, 12),
        16:(10, 11), 17:(10, 12), 18:(11, 13), 19:(11, 14), 20:(12, 13),
        21:(12, 23), 22:(13, 23), 23:(14, 16), 24:(15, 16), 25:(15, 21),
        26:(15, 24), 27:(16, 17), 28:(16, 19), 29:(17, 18), 30:(17, 22),
        31:(18, 21), 32:(19, 20), 33:(20, 23), 34:(21, 22)}
         
r = { 1:0.0026,  2:0.0546,  3:0.0218,  4:0.0328,   5:0.0497,  6:0.0308,  7:0.0023, 
	  8:0.0268,  9:0.0228, 10:0.0139, 11:0.0159,  12:0.0427, 13:0.0427, 14:0.0023, 
	 15:0.0023, 16:0.0023, 17:0.0023, 18:0.0061,  19:0.0054, 20:0.0061, 21:0.0124, 
	 22:0.0111, 23:0.005,  24:0.0022, 25:0.00315, 26:0.0067, 27:0.0033, 28:0.003, 
	 29:0.0018, 30:0.0135, 31:0.00165, 32:0.00255, 33:0.0014, 34:0.0087}

x = { 1:0.0139,  2:0.2112,   3:0.0845,  4:0.1267,  5:0.192,   6:0.119,   7:0.0839,
      8:0.1037,  9:0.0883, 10:0.0605,  11:0.0614, 12:0.1651, 13:0.1651, 14:0.0839,
     15:0.0839, 16:0.0839, 17:0.0839,  18:0.0476, 19:0.0418, 20:0.0476, 21:0.0966,
     22:0.0865, 23:0.0389, 24:0.0173,  25:0.0245, 26:0.0519, 27:0.0259, 28:0.0231,
     29:0.0144, 30:0.1053, 31:0.01295, 32:0.0198, 33:0.0108, 34:0.0678}

b = { 1:0.4611,  2:0.0572,  3:0.0229,  4:0.0343,  5:0.052,   6:0.0322,  7:0,  8:0.0281, 9:0.0239, 
	 10:2.459,  11:0.0166, 12:0.0447, 13:0.0447, 14:0,      15:0,      16:0, 17:0, 18:0.0999, 
	 19:0.0879, 20:0.0999, 21:0.203,  22:0.1818, 23:0.0818, 24:0.0364, 25:0.206, 26:0.1091, 
	 27:0.0545, 28:0.0485, 29:0.0303, 30:0.2212, 31:0.109,  32:0.1666, 33:0.091, 34:0.1424}

Llim = { 1:175,  2:175,   3:175,  4:175,  5:175,  6:175,  7:400,  8:175,   9:175,  10:175, 11:175, 12:175, 
	    13:175, 14:400,  15:400, 16:400, 17:400, 18:500, 19:500, 20:500,  21:500,  22:500, 23:500, 
	    24:500, 25:1000, 26:500, 27:500, 28:500, 29:500, 30:500, 31:1000, 32:1000, 33:1000, 34:500}

cond={}
sub={}
for l in L:
    cond[l]=r[l]/(r[l]**2+x[l]**2)
    sub[l]=-x[l]/(r[l]**2+x[l]**2)

print(cond)

#datos de la demanda
D    = ["d1",     "d2",    "d3",     "d4",    "d5",    "d6",     "d7",     "d8",
        "d9",     "d10",   "d11",    "d12",   "d13",   "d14",    "d15",    "d16",
        "d17"]

BusD = {"d1":1,   "d2":2,  "d3":3,   "d4":4,  "d5":5,  "d6":6,   "d7":7,   "d8":8,
        "d9":9,   "d10":10,"d11":13, "d12":14,"d13":15,"d14":16, "d15":18, "d16":19,
        "d17":20}

Pdmax= {"d1":108, "d2":97, "d3":180, "d4":74, "d5":71, "d6":136, "d7":125, "d8":171,
        "d9":175, "d10":195,"d11":265,"d12":194, "d13":317, "d14":100, "d15":333, "d16":181,
        "d17":128}

LoadB = { "d1":3685, "d2":3644,   "d3":3613,   "d4":3600,  "d5":3589,    "d6":3598,  "d7":3627,  "d8":3652, 
          "d9":3706, "d10":3787, "d11":3839,  "d12":3853, "d13":3871, "d14":3834, "d15":3817, "d16":3819,
         "d17":3874, "d18":1000, "d19":3984, "d20":3936, "d21":3888, "d22":3809, "d23":3746, "d24":3733}

LB = {}
for t in T:
    for d in D:
        for de in Dem:
            LB[(d,t)] = Dem[t]

#print("Demanda (d,t)")            
#print(LB)